{% extends "base.html" %}

{% block title %}Meeting Detail - Teams Meeting Summarizer{% endblock %}

{% block content %}
<div x-data="meetingDetailData({{ meeting_id }})" x-init="loadMeeting()">
    <div class="mb-4">
        <a href="/dashboard/meetings" class="text-blue-600 hover:underline">&larr; Back to Meetings</a>
    </div>

    <h1 class="text-3xl font-bold text-gray-900 mb-6" x-text="meeting.subject || 'Loading...'"></h1>

    <div class="bg-white shadow rounded-lg p-6 mb-6">
        <h2 class="text-xl font-semibold mb-4">Meeting Summary</h2>
        <div x-show="meeting.summary_text" class="prose max-w-none" x-html="renderMarkdown(meeting.summary_text)"></div>
        <div x-show="!meeting.summary_text" class="text-gray-500">Summary not available</div>
    </div>

    <div class="bg-white shadow rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">Transcript Preview</h2>
        <pre x-text="meeting.transcript_preview || 'Transcript not available'" class="text-sm text-gray-700 whitespace-pre-wrap"></pre>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
function meetingDetailData(meetingId) {
    return {
        meeting: {},
        async loadMeeting() {
            try {
                const response = await fetch(`/api/meetings/${meetingId}`);
                this.meeting = await response.json();
            } catch (error) {
                console.error('Failed to load meeting:', error);
            }
        },
        renderMarkdown(text) {
            if (!text) return '';
            return marked.parse(text);
        }
    }
}
</script>
{% endblock %}
